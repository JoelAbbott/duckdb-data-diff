# CORRECTED INVENTORY BALANCE TEST - Using proper serial_number_id key
# Root Cause: Previous config incorrectly mapped serial_number_id -> serial_lot_number
# Solution: Both datasets have serial_number_id with identical values - no mapping needed

datasets:
  # Left dataset - NetSuite Inventory Balance  
  netsuite_inventory_balance_corrected:
    path: "data/raw/netsuite_inventory_balance (1).csv"
    type: "csv"
    key_columns: ["serial_number_id"]
    
  # Right dataset - QA2 NetSuite Inventory Balance
  qa2_netsuite_inventory_balance_corrected:
    path: "data/raw/qa2_netsuite_inventory_balance.xlsx"
    type: "excel"
    key_columns: ["serial_number_id"]
    # NO COLUMN MAPPING NEEDED - both datasets use identical serial_number_id

comparisons:
  # This comparison should now achieve HIGH match rate (5,840+ matches expected)
  - left: "netsuite_inventory_balance_corrected"
    right: "qa2_netsuite_inventory_balance_corrected"
    keys: ["serial_number_id"]
    output_format: "csv"
    max_differences: 100