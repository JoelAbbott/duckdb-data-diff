datasets:
  left_file:
    path: "data/raw/left.xlsx"
    sheet: "Sheet1"
    keys: ["invoice_id","line_num"]
    column_map:
      "Invoice ID": invoice_id
      "Line#": line_num
      "SKU Code": sku
      "Qty": quantity
      "Unit Price ($)": unit_price
      "Invoice Date": invoice_date
      "Last Modified": last_modified
    dtypes:
      invoice_id: string
      line_num: int64
      sku: string
      quantity: int64
      unit_price: currency_usd
      invoice_date: date
      last_modified: date
    normalizers:
      invoice_id: [unicode_clean]
      sku: [unicode_clean, upper, collapse_spaces]

  right_file:
    path: "data/raw/right.csv"
    keys: ["invoice_id","line_num"]
    column_map:
      "Invoice ID": invoice_id
      "Line": line_num
      "Item": sku
      "Qty Ordered": quantity
      "Unit Price": unit_price
      "Job Date": invoice_date
      "LastModified": last_modified
    dtypes:
      invoice_id: string
      line_num: int64
      sku: string
      quantity: int64
      unit_price: currency_usd
      invoice_date: date
      last_modified: date
    normalizers:
      invoice_id: [unicode_clean]
      sku: [unicode_clean, upper, collapse_spaces]

comparisons:
  - name: "invoices_vs_jobs"
    left: "left_file"
    right: "right_file"
    keys: ["invoice_id","line_num"]
    compare_columns: [sku, quantity, unit_price, invoice_date]
    numeric_round: 4
    date_filter:
      column_left: last_modified
      column_right: last_modified
      cutoff: "2025-06-30"
      operator: "<="